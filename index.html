<html>

<head>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <title>A Leaflet map!</title>
    <link rel="stylesheet" href="./leaflet/leaflet.css"/>
    <script src="./leaflet/leaflet.js"></script>

    <script src="leaflet-gpx-master/gpx.min.js"></script>
    <script src="./data/roadtrips.js"></script>
    <script src="./keys.js"></script>
    <style>
        #map {
            width: 100%;
            height: 100%;
        }
    </style>

</head>

<body>
<!-- To display the map -->
<div id="map"></div>

<script>

    // initialize the map
    var map = L.map('map').setView([45, -40], 3.4);

    // load a tile layer
    L.tileLayer('http://a.tile.opentopomap.org/{z}/{x}/{y}.png', {
        attribution: 'Tiles by <a href="https://opentopomap.org/">OpenTopoMap</a>',
        maxZoom: 17,
        minZoom: 1
    }).addTo(map);

    // TODO activate after debugging
    //L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
    //    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
    //    maxZoom: 18,
    //    id: 'mapbox/streets-v11',
    //    tileSize: 512,
    //    zoomOffset: -1,
    //    accessToken: keys.mapbox
    //}).addTo(map);
    // https://account.mapbox.com/auth/signup/



    var gpx = california;

    var g = new L.GPX(gpx, {
        async: true,
        parseElements: ['track'],
        polyline_options: {
            color: 'blue'
        }
    });


    g.on('loaded', function(e) {
        var gpx = e.target,
            name = gpx.get_name(),
            distM = gpx.get_distance(),
            distKm = distM / 1000,
            distKmRnd = distKm.toFixed(1),
            eleGain = gpx.get_elevation_gain().toFixed(0),
            eleLoss = gpx.get_elevation_loss().toFixed(0);
        var info = "Name: " + name + "</br>" +
            "Distance: " + distKmRnd + " km </br>" +
            "Elevation Gain: " + eleGain + " m </br>"

        // register popup on click
        gpx.getLayers()[0].bindPopup(info)
    });

    g.addTo(map);





</script>
</body>

</html>